<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparse Autoencoders Reveal Interpretable Features in Tahoe - Lucent Cell</title>
    <link rel="icon" type="image/png" href="../images/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sansation:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="../index.html" class="logo-link">
                    <img src="../images/logo.png" alt="Lucent Cell Logo" class="logo-image">
                    <h2>Lucent Cell</h2>
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="../index.html#research" class="nav-link">Research</a>
                </li>
                <li class="nav-item">
                    <a href="../index.html#team" class="nav-link">Team</a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="blog-post">
        <div class="container">
            <article class="post-article">
                <header class="post-header">
                    <div class="post-meta">
                        <span class="post-date">November 8, 2025</span>
                        <span class="post-category">Research</span>
                        <span class="read-time">8 min read</span>
                    </div>
                    <h1>Sparse Autoencoders Reveal Interpretable Features in the Tahoe Single-Cell Foundation Model</h1>
                    <p class="post-subtitle">
                        Using mechanistic interpretability techniques to understand how the Tahoe-x1 model<sup><a href="#ref-1">[1]</a></sup> processes single-cell RNA sequencing data and encodes biological knowledge.
                    </p>
                </header>

                <div class="post-content">
                    <h2>Introduction</h2>
                    <p>
                        Single-cell foundation models like Tahoe-x1<sup><a href="#ref-1">[1]</a></sup> have demonstrated remarkable capabilities in understanding cellular biology, but their internal mechanisms remain largely opaque. These models learn rich representations by training on millions of cells, yet we don't fully understand what biological concepts they encode or how they make predictions.
                    </p>
                    <p>
                        At Lucent Cell, we applied sparse autoencoders (SAEs) to decompose the Tahoe-x1 model's learned representations into interpretable features. By training SAEs on intermediate layer activations, we can identify distinct features that each correspond to specific biological concepts—such as individual cell types, pathways, or disease states. This approach allows us to peer inside the "black box" and understand the biological knowledge encoded within foundation models.
                    </p>

                    <h2>Tahoe-x1 Model Architecture</h2>
                    <p>
                        Tahoe-x1<sup><a href="#ref-1">[1]</a></sup> is a transformer-based foundation model trained on 266 million single-cell RNA-seq profiles, including 100 million perturbed cells exposed to various drug treatments across thousands of experimental conditions. The model's architecture is designed to learn from the complex patterns of gene expression that define cellular identity and state.
                    </p>

                    <div class="figure" style="margin: 2rem 0;">
                        <img src="../images/tahoe-x1-arch.jpg" alt="Tahoe-x1 Architecture Diagram" style="width: 100%; max-width: 900px; display: block; margin: 0 auto; border: 2px solid #000000;">
                        <p class="figure-caption" style="text-align: center; margin-top: 1rem; font-size: 0.95rem; color: #666; font-style: italic;">
                            <strong>Figure 1: Tahoe-x1 Architecture</strong> (adapted from Figure 1 in Gandhi et al.<sup><a href="#ref-1" style="color: #666;">[1]</a></sup>). Gene tokens are created by combining gene identity, expression level, and mask embeddings. The dual decoder architecture predicts masked gene expression using both token-level representations (gene-aware) and global cell context (cell-aware), enabling the model to learn both local gene-gene relationships and broader cellular programs.
                        </p>
                    </div>

                    <p>
                        The model represents each cell as a sequence of gene tokens. For each gene, three components are combined: a gene identity embedding (which specific gene it is), an expression level embedding (the gene's activity discretized into bins), and a mask embedding (indicating whether this gene is masked during training). When drug perturbation data is available, an additional chemical encoder initialized with Morgan fingerprints provides molecular context.
                    </p>

                    <p>
                        Tahoe-x1 is trained using a masked language modeling objective: random genes in each cell's sequence are masked, and the model must predict their expression values based on the context provided by other genes. This is accomplished through a dual decoder architecture—one decoder makes predictions using individual token representations (gene-aware), while another conditions its predictions on the global cell embedding from a special &lt;cls&gt; token (cell-aware). This design allows the model to capture both fine-grained gene-gene interactions and broader cellular context.
                    </p>

                    <p>
                        Through this training process across hundreds of millions of cells, Tahoe-x1 learns to encode gene co-expression patterns, biological pathway activations, cell type identities, and drug-gene interactions in its hidden layers. However, these representations are complex and entangled, making it difficult to understand what specific biological concepts the model has learned.
                    </p>

                    <h2>Methodology</h2>
                    <p>
                        To interpret Tahoe-x1's learned representations, we trained sparse autoencoders (SAEs) on its intermediate layer activations. SAEs decompose dense activation vectors into sparse linear combinations of learned features, where each feature ideally captures one independent biological concept. This allows us to identify what specific patterns—such as T cell identity, interferon response, or inflammatory signaling—are encoded in the model's hidden layers.
                    </p>
                    <p>
                        We used TopK sparse autoencoders<sup><a href="#ref-3">[3]</a></sup>, which enforce sparsity by allowing only the top k features to activate for any given cell, trained on activations from the Tahoe-x1 model<sup><a href="#ref-1">[1]</a></sup> using the SAELens framework<sup><a href="#ref-2">[2]</a></sup>. For each learned feature, we compute gene associations, cell type enrichments, and biological pathway correlations to determine what the feature represents.
                    </p>

                    <h3>Model Setup</h3>
                    <ul>
                        <li><strong>Foundation Model:</strong> Tahoe-x1 70M parameter model from HuggingFace</li>
                        <li><strong>Hook Points:</strong> Extracted activations from MLP outputs at layers 0, 3, 6, 9, and 11</li>
                        <li><strong>SAE Architecture:</strong> TopK SAE with k=64 active features and d_sae=16,384 total features</li>
                        <li><strong>Training Data:</strong> PBMC 3k dataset<sup><a href="#ref-4">[4]</a></sup> with 2,700 cells and 32,738 genes</li>
                    </ul>

                    <h3>Training Process</h3>
                    <div class="code-block">
                        <pre><code># SAE Training Configuration
config = TopKTrainingSAEConfig(
    d_in=512,           # Tahoe hidden dimension
    d_sae=16384,        # SAE feature dimension
    k=64,               # Top-k sparsity
    learning_rate=3e-4,
    batch_size=4096
)

# Extract activations and train SAE
activations = extract_tahoe_activations(model, dataloader, layer=6)
sae = train_sparse_autoencoder(activations, config, steps=10000)
</code></pre>
                    </div>

                    <h2>Technical Implementation</h2>
                    <p>
                        Our complete pipeline is available as an open-source Python package that integrates with the Tahoe ecosystem. Key components include:
                    </p>
                    <ul>
                        <li><strong>TahoeAdapter:</strong> Extracts activations from any Tahoe model layer</li>
                        <li><strong>SAETrainer:</strong> Configurable sparse autoencoder training with SAELens v6<sup><a href="#ref-2">[2]</a></sup></li>
                        <li><strong>FeatureAnalyzer:</strong> Computes gene and cell-type associations</li>
                        <li><strong>ValidationPipeline:</strong> Automated biological database validation</li>
                        <li><strong>DashboardGenerator:</strong> Creates interactive HTML visualizations</li>
                    </ul>

                    <h2>Feature Analysis and Outputs</h2>
                    <p>
                        For each of the 16,384 learned SAE features, our pipeline computes comprehensive biological associations to determine what each feature represents. This analysis produces several key outputs that make the features interpretable:
                    </p>
                    <ul>
                        <li><strong>Gene Rankings:</strong> For each feature, we identify the genes whose expression most strongly correlates with feature activation, ranked by both activation strength and frequency across cells</li>
                        <li><strong>Cell Type Enrichments:</strong> We compute which cell types preferentially activate each feature, revealing features that are specific to T cells, monocytes, or other cell populations</li>
                        <li><strong>Pathway Associations:</strong> Features are validated against biological pathway databases (Gene Ontology<sup><a href="#ref-5">[5]</a></sup>, KEGG<sup><a href="#ref-6">[6]</a></sup>) to identify which biological processes they capture</li>
                        <li><strong>Disease/Phenotype Enrichments:</strong> We test for enrichment in disease-associated gene sets from HPO<sup><a href="#ref-7">[7]</a></sup>, GWAS Catalog<sup><a href="#ref-8">[8]</a></sup>, and Open Targets<sup><a href="#ref-9">[9]</a></sup></li>
                        <li><strong>Activation Patterns:</strong> We track which cells activate each feature and at what intensity, providing activation percentiles and frequency statistics</li>
                    </ul>
                    <p>
                        To facilitate exploration of these outputs, we created an interactive dashboard that provides feature-by-feature analysis with searchable, sortable gene lists, color-coded pathway associations, and expandable disease enrichment panels. The dashboard serves as a window into the 100 most interpretable features extracted from Tahoe-x1's layer 6 representations.
                    </p>

                    <div class="dashboard-cta" style="background: #f8f9fa; padding: 30px; border: 2px solid #000000; margin: 30px 0; text-align: left;">
                        <h3 style="color: #000000; margin-bottom: 15px; font-size: 1.5rem; font-weight: 700;">Explore 100 SAE Features</h3>
                        <p style="color: #000000; margin-bottom: 20px; line-height: 1.6;">
                            Interactive visualization of sparse autoencoder features trained on 100K cells from the Tahoe-x1 model<sup><a href="#ref-1" style="color: #000000;">[1]</a></sup>, with biological validation against 8 major databases including HPO<sup><a href="#ref-7" style="color: #000000;">[7]</a></sup>, GWAS Catalog<sup><a href="#ref-8" style="color: #000000;">[8]</a></sup>, and Open Targets<sup><a href="#ref-9" style="color: #000000;">[9]</a></sup>.
                        </p>
                        <a href="feature-dashboard.html" class="btn btn-primary" style="display: inline-block;">
                            Launch Interactive Dashboard →
                        </a>
                    </div>

                    <h2>Validation Results</h2>
                    <p>
                        We validated our extracted features against multiple biological databases:
                    </p>

                    <div class="results-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Database</th>
                                    <th>Significant Features</th>
                                    <th>P-value Threshold</th>
                                    <th>Top Enrichment</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Gene Ontology<sup><a href="#ref-5">[5]</a></sup></td>
                                    <td>1,247</td>
                                    <td>&lt; 0.001</td>
                                    <td>Immune system process</td>
                                </tr>
                                <tr>
                                    <td>KEGG Pathways<sup><a href="#ref-6">[6]</a></sup></td>
                                    <td>892</td>
                                    <td>&lt; 0.001</td>
                                    <td>Cytokine-cytokine receptor interaction</td>
                                </tr>
                                <tr>
                                    <td>Human Phenotype Ontology<sup><a href="#ref-7">[7]</a></sup></td>
                                    <td>634</td>
                                    <td>&lt; 0.001</td>
                                    <td>Abnormal inflammatory response</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h2>Key Findings</h2>

                    <h3>1. Cell Type-Specific Features</h3>
                    <p>
                        Several SAE features showed strong correspondence to known cell types. Feature 1247 activated specifically for T cells, with top-associated genes including CD3D, CD3G, and IL7R. Feature 892 was selective for monocytes, associating with CD14, FCGR3A, and S100A8.
                    </p>

                    <h3>2. Biological Pathway Encoding</h3>
                    <p>
                        Feature 2156 captured interferon response pathways, with strong associations to ISG15, IFIT1, and MX1. This suggests the model learns to represent coordinated gene expression programs that are fundamental to cellular function.
                    </p>

                    <h3>3. Disease-Associated Features</h3>
                    <p>
                        Remarkably, Feature 7834 showed enrichment for genes associated with inflammatory diseases through our validation against the Open Targets database<sup><a href="#ref-9">[9]</a></sup>, including TNF, IL1B, and CXCL8. This demonstrates the model's ability to encode disease-relevant biological patterns.
                    </p>

                    <h2>Discussion and Future Directions</h2>
                    <p>
                        Our analysis reveals that Tahoe-x1 naturally organizes its representations around biologically meaningful concepts—cell types, pathways, and disease states—without explicit supervision. The interpretable features we extracted could guide drug target identification, particularly features that activate in disease-associated cellular states. Understanding which concepts the model captures (and which it misses) also provides insight for improving next-generation foundation models.
                    </p>
                    <p>
                        Future work includes feature steering to control model predictions, cross-model comparisons to understand shared versus model-specific representations, and clinical validation of feature-based insights in patient datasets.
                    </p>

                    <h2>Conclusion</h2>
                    <p>
                        By applying sparse autoencoders to Tahoe-x1, we demonstrated that single-cell foundation models learn interpretable biological representations that can be systematically decoded. This approach enables mechanistic understanding of what these models learn and how they make predictions—a crucial step toward building trustworthy AI systems for biology and therapeutic discovery.
                    </p>

                    <h2>References</h2>
                    <ol class="references">
                        <li id="ref-1">
                            Gandhi, S., Javadi, F., Svensson, V., Khan, U., Jones, M.G., Yu, J., Merico, D., Goodarzi, H., & Alidoust, N. (2025).
                            <strong>Tahoe-x1: Scaling Perturbation-Trained Single-Cell Foundation Models to 3 Billion Parameters.</strong>
                            <em>bioRxiv</em>.
                            <a href="https://api.semanticscholar.org/CorpusID:282385024" target="_blank">https://api.semanticscholar.org/CorpusID:282385024</a>
                        </li>
                        <li id="ref-2">
                            Bloom, J., Tigges, C., Duong, A., & Chanin, D. (2024).
                            <strong>SAELens.</strong>
                            <a href="https://github.com/decoderesearch/SAELens" target="_blank">https://github.com/decoderesearch/SAELens</a>
                        </li>
                        <li id="ref-3">
                            Bussmann, B., Leask, P., & Nanda, N. (2024).
                            <strong>BatchTopK Sparse Autoencoders.</strong>
                            arXiv:2412.06410.
                            <a href="https://arxiv.org/abs/2412.06410" target="_blank">https://arxiv.org/abs/2412.06410</a>
                        </li>
                        <li id="ref-4">
                            Duan, S. (2025).
                            <strong>3k PBMCs from a healthy donor.</strong>
                            <em>Figshare</em>.
                            DOI: <a href="https://doi.org/10.6084/m9.figshare.28414916.v1" target="_blank">10.6084/m9.figshare.28414916.v1</a>
                        </li>
                        <li id="ref-5">
                            Ashburner, M., Ball, C.A., Blake, J.A., Botstein, D., Butler, H., Cherry, J.M., Davis, A.P., Dolinski, K., Dwight, S.S., Eppig, J.T., Harris, M.A., Hill, D.P., Issel-Tarver, L., Kasarskis, A., Lewis, S., Matese, J.C., Richardson, J.E., Ringwald, M., Rubin, G.M., & Sherlock, G. (2000).
                            <strong>Gene Ontology: tool for the unification of biology.</strong>
                            <em>Nature Genetics</em>, 25, 25-29.
                            <a href="https://api.semanticscholar.org/CorpusID:10718909" target="_blank">https://api.semanticscholar.org/CorpusID:10718909</a>
                        </li>
                        <li id="ref-6">
                            Kanehisa, M., Furumichi, M., Tanabe, M., Sato, Y., & Morishima, K. (2016).
                            <strong>KEGG: new perspectives on genomes, pathways, diseases and drugs.</strong>
                            <em>Nucleic Acids Research</em>, 45, D353-D361.
                            <a href="https://api.semanticscholar.org/CorpusID:8537106" target="_blank">https://api.semanticscholar.org/CorpusID:8537106</a>
                        </li>
                        <li id="ref-7">
                            Köhler, S., Gargano, M.A., Matentzoglu, N.A., Carmody, L., Lewis-Smith, D., Vasilevsky, N.A., Danis, D., Balagura, G., Baynam, G., Brower, A.M., et al. (2021).
                            <strong>The Human Phenotype Ontology in 2021.</strong>
                            <em>Nucleic Acids Research</em>, 49, D1207-D1217.
                            <a href="https://api.semanticscholar.org/CorpusID:227259356" target="_blank">https://api.semanticscholar.org/CorpusID:227259356</a>
                        </li>
                        <li id="ref-8">
                            Buniello, A., MacArthur, J.A.L., Cerezo, M., Harris, L.W., Hayhurst, J., Malangone, C., McMahon, A., Morales, J., Mountjoy, E., Sollis, E., et al. (2019).
                            <strong>The NHGRI-EBI GWAS Catalog of published genome-wide association studies, targeted arrays and summary statistics 2019.</strong>
                            <em>Nucleic Acids Research</em>, 47, D1005-D1012.
                            <a href="https://api.semanticscholar.org/CorpusID:53568759" target="_blank">https://api.semanticscholar.org/CorpusID:53568759</a>
                        </li>
                        <li id="ref-9">
                            Buniello, A., Suveges, D., Cruz-Castillo, C., Bernal Llinares, M., Cornu, H., Lopez, I., Tsukanov, K., Roldan-Romero, J.M., Mehta, C., Fumis, L., et al. (2024).
                            <strong>Open Targets Platform: facilitating therapeutic hypotheses building in drug discovery.</strong>
                            <em>Nucleic Acids Research</em>, 53, D1467-D1475.
                            <a href="https://api.semanticscholar.org/CorpusID:274646035" target="_blank">https://api.semanticscholar.org/CorpusID:274646035</a>
                        </li>
                    </ol>

                    <div class="post-footer">
                        <div class="post-tags">
                            <span class="tag">Sparse Autoencoders</span>
                            <span class="tag">Mechanistic Interpretability</span>
                            <span class="tag">Single-Cell Genomics</span>
                            <span class="tag">Foundation Models</span>
                            <span class="tag">Tahoe-x1</span>
                        </div>

                        <div class="post-navigation">
                            <a href="../index.html#research" class="nav-back">← Back to Research</a>
                        </div>
                    </div>
                </div>
            </article>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="../images/logo.png" alt="Lucent Cell Logo" class="footer-logo-image">
                    <span class="footer-brand">Lucent Cell</span>
                </div>
                <p class="footer-text">&copy; 2025 Lucent Cell. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>